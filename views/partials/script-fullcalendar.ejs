<script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.10.0/main.min.js"></script>
<script>
window['hebcal']=window['hebcal']||{};
window['hebcal'].fcEvents=<%- JSON.stringify(fcEvents) %>;
</script>
<script>
document.addEventListener('DOMContentLoaded', function() {
  var calendarEl = document.getElementById('calendar');
  calendarEl.style.display = 'none';
  var events = window['hebcal'].fcEvents;
  var lastEvent = events[events.length - 1];
  var lastEvDate = lastEvent.start;
  var lastYear = parseInt(lastEvDate.substring(0, 4), 10);
  var lastMonth = parseInt(lastEvDate.substring(5, 7), 10);
  var firstOfNextMonth = new Date(lastYear, lastMonth, 1);
  var calendar = window['hebcalFullCalendar'] = new FullCalendar.Calendar(calendarEl, {
    initialView: 'dayGridMonth',
    headerToolbar: {
      left: 'title',
      right: 'prev,next',
    },
    events: events,
    initialDate: events[0].start,
    validRange: {
        start: events[0].start.substring(0, 7) + '-01',
        end: firstOfNextMonth,
    },
/*
    eventDidMount: function(info) {
      if (info.event.extendedProps.description) {
        tippy(info.el, {
          content: info.event.extendedProps.description.replace(/\n/g, '<br>'),
          allowHTML: true,
        });
      }
    },
*/
  });
  var listViewEl = document.getElementById('list-view');
  listViewEl.style.display = 'block';
  var toggleMonth = document.getElementById('toggle-month');
  toggleMonth.onchange = function() {
    calendarEl.style.display = 'block';
    calendar.render();
    listViewEl.style.display = 'none';
    toggleMonth.blur();
  };
  var toggleList = document.getElementById('toggle-list');
  toggleList.onchange = function() {
    calendarEl.style.display = 'none';
    listViewEl.style.display = 'block';
  };
  document.addEventListener('keydown', function(e) {
    if (e.keyCode == 37) {
        window['hebcalFullCalendar'].prev();
    } else if (e.keyCode == 39) {
        window['hebcalFullCalendar'].next();
    }
  });
});
</script>
